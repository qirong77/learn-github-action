"use strict";(self["webpackChunkv3"]=self["webpackChunkv3"]||[]).push([[5197],{71256:function(e,t,i){i.r(t),i.d(t,{default:function(){return ie}});var o=i(66252),s=i(49963);const n=e=>((0,o.dD)("data-v-9744a69c"),e=e(),(0,o.Cn)(),e),l={id:"couponAssign"},a=n((()=>(0,o._)("div",{class:"tableHeader"},[(0,o._)("p",null,"发布时间"),(0,o._)("p",null,"用户ID"),(0,o._)("p",null,"优惠券ID"),(0,o._)("p",null,"生效时间"),(0,o._)("p",null,"失效时间"),(0,o._)("p",null,"发放理由")],-1))),r=n((()=>(0,o._)("div",{class:"divideLine"},null,-1))),d=n((()=>(0,o._)("div",{class:"emptyDiv"},null,-1))),c={class:"content2"},u={class:"paginationZone"},h={class:"fixedFullLoading"},p={class:"bottom"},m={class:"user-wrap"},g=n((()=>(0,o._)("label",{for:"user-id"},"用户ID",-1))),w={key:0,class:"distribute-toast"};function _(e,t,i,n,_,v){const b=(0,o.up)("order-list"),f=(0,o.up)("a-pagination"),D=(0,o.up)("empty-data-placeholder"),S=(0,o.up)("a-spin"),x=(0,o.up)("a-space"),y=(0,o.up)("distribute-coupon");return(0,o.wg)(),(0,o.iD)("div",l,[a,r,d,(0,o._)("div",c,[(0,o.Wm)(b,{list:_.listShow},null,8,["list"]),(0,o.wy)((0,o._)("div",u,[(0,o.Wm)(f,{total:_.listAll.length,"show-total":(e,t)=>`${t[0]}-${t[1]} of ${e} items`,"page-size":_.pageSize,"default-current":1,current:_.currentPage,"onUpdate:current":t[0]||(t[0]=e=>_.currentPage=e)},null,8,["total","show-total","page-size","current"])],512),[[s.F8,0!==_.listShow.length]]),0===_.listShow.length?((0,o.wg)(),(0,o.j4)(D,{key:0,description:"暂无工单数据"})):(0,o.kq)("",!0)]),(0,o.wy)((0,o._)("div",h,[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(S,{size:"large"})])),_:1})],512),[[s.F8,_.isLoading]]),(0,o._)("div",p,[(0,o._)("div",m,[g,(0,o.wy)((0,o._)("input",{id:"user-id",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>_.user_id=e)},null,512),[[s.nr,_.user_id]])]),(0,o._)("div",{class:"button b1",onClick:t[2]||(t[2]=(...e)=>v.refresh&&v.refresh(...e))},"搜索"),(0,o._)("div",{class:"button b2",onClick:t[3]||(t[3]=(...e)=>v.showDistributeCouponDialog&&v.showDistributeCouponDialog(...e))}," 发放优惠券 ")]),_.ifShowDistributeCoupon?((0,o.wg)(),(0,o.iD)("div",w,[(0,o.Wm)(y,{class:"distribute-coupon",onHideDialog:v.hideDistributeCouponDialog,onDistributeCoupon:e.distributeCoupon},null,8,["onHideDialog","onDistributeCoupon"])])):(0,o.kq)("",!0)])}var v=i(27623);const b={id:"order-list"};function f(e,t,i,s,n,l){const a=(0,o.up)("list-item");return(0,o.wg)(),(0,o.iD)("div",b,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.list,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"list-item"},[(0,o.Wm)(a,{item:e,index:t},null,8,["item","index"])])))),128))])}var D=i(3577);const S={class:"list-item"},x={class:"order-content"};function y(e,t,i,s,n,l){return(0,o.wg)(),(0,o.iD)("div",S,[(0,o._)("div",x,[(0,o._)("div",null,(0,D.zw)(l.setDate(i.item.date_created)),1),(0,o._)("div",null,(0,D.zw)(i.item.user),1),(0,o._)("div",null,(0,D.zw)(i.item.coupon.id),1),(0,o._)("div",null,(0,D.zw)(l.setDate(i.item.date_start)),1),(0,o._)("div",null,(0,D.zw)(l.setDate(i.item.date_expired)),1),(0,o._)("div",null,(0,D.zw)(i.item.create_reason),1)])])}var C=i(5050),I={name:"e-AssignListItem",props:{item:{type:Object,default(){return{}}},index:{type:Number}},data(){return{}},mounted(){this.$nextTick((()=>{}))},methods:{setDate(e){return(0,C.h3)(e)}},components:{}},k=i(83744);const O=(0,k.Z)(I,[["render",y],["__scopeId","data-v-3a5f2ccc"]]);var z=O,M={name:"e-Orderlist",props:{list:{type:Array,default(){return[]}}},methods:{viewDetails(e){var t=e||window.event;let i={x:t.clientX,y:t.clientY};console.log("client:"),console.log(i)}},components:{ListItem:z}};const $=(0,k.Z)(M,[["render",f]]);var j=$;const P=e=>((0,o.dD)("data-v-51e4d8ed"),e=e(),(0,o.Cn)(),e),E={class:"distributeCoupon"},A={class:"top"},L=P((()=>(0,o._)("div",{class:"title"},"发放优惠券",-1))),R={class:"form"},U={class:"form-item user-id"},Z=P((()=>(0,o._)("label",{for:"user-id"},"用户ID",-1))),N={class:"form-item coupon-id"},V=P((()=>(0,o._)("label",{for:"coupon-id"},"优惠券ID",-1))),W={class:"form-item"},J=P((()=>(0,o._)("label",{for:"start_date"},"生效时间",-1))),H={class:"form-item"},F=P((()=>(0,o._)("label",{for:"expire_date"},"失效时间",-1))),T={class:"buttonZone"},q={class:"edit-reason"};function B(e,t,i,n,l,a){const r=(0,o.up)("edit-reason-dialog");return(0,o.wg)(),(0,o.iD)("div",E,[(0,o._)("div",A,[(0,o._)("div",{class:"cancel",onClick:t[0]||(t[0]=(...e)=>a.hideDialog&&a.hideDialog(...e))})]),L,(0,o._)("div",R,[(0,o._)("div",U,[Z,(0,o.wy)((0,o._)("input",{type:"text",placeholder:"",id:"user-id",class:"form-item-content","onUpdate:modelValue":t[1]||(t[1]=e=>l.monitoredMixedObj.user_id=e),ref:"userid"},null,512),[[s.nr,l.monitoredMixedObj.user_id]])]),(0,o._)("div",N,[V,(0,o.wy)((0,o._)("input",{type:"text",placeholder:"",id:"coupon-id",class:"form-item-content","onUpdate:modelValue":t[2]||(t[2]=e=>l.monitoredMixedObj.coupon_id=e),ref:"couponid"},null,512),[[s.nr,l.monitoredMixedObj.coupon_id]])]),(0,o._)("div",W,[J,(0,o.wy)((0,o._)("input",{id:"start_date",type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>l.monitoredMixedObj.start_date=e)},null,512),[[s.nr,l.monitoredMixedObj.start_date]])]),(0,o._)("div",H,[F,(0,o.wy)((0,o._)("input",{id:"expire_date",type:"date","onUpdate:modelValue":t[4]||(t[4]=e=>l.monitoredMixedObj.expire_date=e)},null,512),[[s.nr,l.monitoredMixedObj.expire_date]])])]),(0,o._)("div",T,[(0,o._)("button",{class:"cancelBtn other-button",onClick:t[5]||(t[5]=(...e)=>a.hideDialog&&a.hideDialog(...e))},"取消"),(0,o._)("button",{class:"ensureBtn submit-button",onClick:t[6]||(t[6]=(...e)=>a.checkInput&&a.checkInput(...e))},"确认")]),(0,o.wy)((0,o._)("div",q,[(0,o.Wm)(r,{onCancelClick:a.hideEditReason,onEnsureClick:a.submit},null,8,["onCancelClick","onEnsureClick"])],512),[[s.F8,l.ifShowEditReason]])])}i(55877);var Q=i(6819),Y=i(81317),K={name:"e-DistributeCoupon",data(){return{monitoredMixedObj:{user_id:"",coupon_id:"",start_date:"",expire_date:""},ifShowEditReason:!1}},created(){this.$nextTick((()=>{this.$refs.userid.focus()}))},methods:{hideDialog(){this.$emit("hideDialog")},checkInput(){""!==this.monitoredMixedObj.user_id?""!==this.monitoredMixedObj.coupon_id?""!==this.monitoredMixedObj.reason?this.showEditReason():this.$toast.error("请填写创建理由",240):this.$toast.error("请完整填写优惠券ID",240):this.$toast.error("请填写用户ID",240)},showEditReason(){this.ifShowEditReason=!0},hideEditReason(){this.ifShowEditReason=!1},async submit(e){let t={id:this.monitoredMixedObj.user_id,coupon_id:this.monitoredMixedObj.coupon_id,date_start:this.monitoredMixedObj.start_date,date_expired:this.monitoredMixedObj.expire_date,create_reason:e};try{const e=await(0,Y.yV)(t),{Code:i,msg:o}=e;console.log(i),console.log(o),200===i&&"success"===o?this.$toast.success("提交成功",240):this.$toast.error("提交失败",240)}catch(i){this.$toast.error("提交失败",240)}this.hideEditReason()}},watch:{},components:{EditReasonDialog:Q.Z}};const X=(0,k.Z)(K,[["render",B],["__scopeId","data-v-51e4d8ed"]]);var G=X,ee={name:"e-CouponAssign",beforeRouteEnter(e,t,i){"true"===window.localStorage.getItem("isStaff")?(window.localStorage.setItem("currentIndex010001",4),i()):(i({path:"/tools/login"}),window.localStorage.removeItem("list"),window.localStorage.removeItem("order"),window.localStorage.removeItem("currentIndex010001"),window.localStorage.removeItem("userID"),window.localStorage.removeItem("username"),window.localStorage.removeItem("authToken"),window.localStorage.removeItem("isStaff"),window.localStorage.removeItem("isSuperUser"),window.localStorage.removeItem("isProvider"),window.localStorage.removeItem("providerID"))},data(){return{ifShowDistributeCoupon:!1,isLoading:!1,listAll:[],listShow:[],pageSize:8,currentPage:1,totalPage:0,isShowCoverPage:!1,showIndex:-1,x:null,y:null,user_id:1}},async mounted(){let e={id:1};this.isLoading=!0;try{const t=await(0,Y.Q1)(e);console.log("coupon",t);const{Code:i,msg:o}=t;if(200===i&&"success"===o){console.log(t.details.coupons),this.listAll=t.details.coupons.reverse(),this.totalPage=Math.ceil(this.listAll.length/this.pageSize);const e=window.JSON.parse(window.JSON.stringify(this.listAll));0===this.listShow.length&&(this.listShow=e.slice(0,this.pageSize)),this.currentPage===this.totalPage&&(this.listShow=e.slice(this.pageSize*(this.currentPage-1),this.pageSize*this.currentPage))}else this.$toast.error("获取工单数据失败 ",240),console.log("获取工单数据失败 ")}catch(t){this.$toast.error("获取工单数据失败  ",240),console.log("获取工单数据失败 ")}this.isLoading=!1},methods:{showDistributeCouponDialog(){this.ifShowDistributeCoupon=!0},hideDistributeCouponDialog(){this.ifShowDistributeCoupon=!1},beforeUnloadHandler(e){this.updateMark&&(e.returnValue="离开此页面?")},async refresh(){let e={id:this.user_id};if(""!==e.id&&/^[0-9]*$/.test(e.id)){this.isLoading=!0;try{const t=await(0,Y.Q1)(e);console.log(e.id);const{Code:i,msg:o}=t;if(200===i&&"success"===o){console.log(t.details.coupons),this.listAll=t.details.coupons.reverse(),this.totalPage=Math.ceil(this.listAll.length/this.pageSize);const e=window.JSON.parse(window.JSON.stringify(this.listAll));this.listShow=e.slice(0,this.pageSize),this.currentPage=1,this.listShow=e.slice(this.pageSize*(this.currentPage-1),this.pageSize*this.currentPage)}else this.$toast.error("获取工单数据失败 ",240),console.log("获取工单数据失败 ")}catch(t){this.$toast.error("获取工单数据失败  ",240),console.log("获取工单数据失败 ")}this.isLoading=!1}else this.$toast.error("请输入正确的用户ID",240)}},watch:{currentPage(e){const t=window.JSON.parse(window.JSON.stringify(this.listAll));this.listShow=t.slice(this.pageSize*(e-1),this.pageSize*e)}},components:{EmptyDataPlaceholder:v.Z,OrderList:j,DistributeCoupon:G}};const te=(0,k.Z)(ee,[["render",_],["__scopeId","data-v-9744a69c"]]);var ie=te}}]);
//# sourceMappingURL=5197.970426c7.js.map