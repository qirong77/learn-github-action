"use strict";(self["webpackChunkv3"]=self["webpackChunkv3"]||[]).push([[7193],{57830:function(e,t,i){i.r(t),i.d(t,{default:function(){return Ee}});var o=i(66252),a=i(49963);const s={id:"category"},n={class:"buttonZone"},l={key:0,class:"right-content-cover-absolute"},r={key:0,class:"right-content-cover-absolute"},d={class:"right-content-cover-absolute"},c={class:"absoluteFullLayout"};function h(e,t,i,h,m,g){const u=(0,o.up)("content-list"),w=(0,o.up)("Scroll"),p=(0,o.up)("add-one"),f=(0,o.up)("edit-one"),y=(0,o.up)("edit-reason-dialog"),C=(0,o.up)("back-top"),I=(0,o.up)("loading");return(0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("div",n,[(0,o._)("p",{onClick:t[0]||(t[0]=(...e)=>g.showAddOneDialog&&g.showAddOneDialog(...e)),class:"addCategoryBtn"},"添加类别")]),m.showimg?((0,o.wg)(),(0,o.j4)(w,{key:0,class:"scroll-content",ref:"scroll",onScroll:g.printPosition,"probe-type":3},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{list:m.list,onDeleteCategoryClick:g.deleteCategoryItem,onNewImageUpload:g.newImageUpload,onEmptyNewTitle:g.emptyNewTitleToast,onFindSameTitle:g.findSameTitleToast,onUpdateTitle:g.updateTitle,onTitleNoChange:g.titleNoChange,onEditDialogshow:g.editDialogshow},null,8,["list","onDeleteCategoryClick","onNewImageUpload","onEmptyNewTitle","onFindSameTitle","onUpdateTitle","onTitleNoChange","onEditDialogshow"])])),_:1},8,["onScroll"])):(0,o.kq)("",!0),(0,o.Wm)(a.uT,{name:"super"},{default:(0,o.w5)((()=>[m.isShowAddOneDialog?((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(p,{list:m.list,onEnsureClick:g.addOne,onCancelClick:g.cancelClickOfAddOne,onEmptyCategoryName:g.emptyCategoryNameToast,onHadSameTitleFromList:g.hadSameTitleFromListToast,onImageUploadSuccess:g.imageUploadSuccessToast,ref:"addone"},null,8,["list","onEnsureClick","onCancelClick","onEmptyCategoryName","onHadSameTitleFromList","onImageUploadSuccess"])])):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(a.uT,{name:"super"},{default:(0,o.w5)((()=>[m.isShowEditOneDialog?((0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(f,{editIndex:m.editIndex,editNum:m.editNum,list:m.list,onCancelClick:g.cancelClickOfEditOne,onEmptyCategoryName:g.emptyCategoryNameToast,onEnsureClick:g.editOne},null,8,["editIndex","editNum","list","onCancelClick","onEmptyCategoryName","onEnsureClick"])])):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(a.uT,{name:"super"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o._)("div",d,[(0,o.Wm)(y,{onEnsureClick:g.deployOrder,onCancelClick:g.cancelClickOfEditReasonDialog,ref:"editReasonDialog"},null,8,["onEnsureClick","onCancelClick"])],512),[[a.F8,m.isShowEditReasonDialog]])])),_:1}),(0,o.wy)((0,o._)("div",c,null,512),[[a.F8,m.isShowCoverPage]]),(0,o.wy)((0,o.Wm)(C,{onClick:g.scrollToTop},null,8,["onClick"]),[[a.F8,m.ifShowBackTop]]),(0,o.Wm)(I,{isLoading:m.isLoading},null,8,["isLoading"])])}var m=i(467),g=i(3577),u=i(26763);const w=e=>((0,o.dD)("data-v-1afc4d39"),e=e(),(0,o.Cn)(),e),p={class:"contentList"},f={class:"bigImage"},y={class:"image"},C=["onClick"],I=w((()=>(0,o._)("div",{class:"error"},[(0,o._)("img",{src:u})],-1))),b=["data-image-id","onChange"],S={class:"thumbTitle"},v={class:"thumb"},k={class:"relativeLayout"},_=["onClick"],N=["data-thumb-id","onChange"],$=["onClick"];function D(e,t,i,s,n,l){const r=(0,o.up)("a-popconfirm"),d=(0,o.up)("a-tooltip"),c=(0,o.up)("content-list-item"),h=(0,o.Q2)("lazy");return(0,o.wg)(),(0,o.iD)("div",p,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.list,((e,i)=>((0,o.wg)(),(0,o.j4)(c,{key:e.id,class:"contentListItem"},{default:(0,o.w5)((()=>[(0,o._)("div",f,[(0,o._)("div",y,[(0,o.wy)((0,o._)("img",{importance:"auto",alt:"big image of category",onLoad:t[0]||(t[0]=(...e)=>l.imageLoad&&l.imageLoad(...e)),onClick:e=>l.imageClick(i),title:"单击上传大图"},null,40,C),[[h,e.image]])]),(0,o.Wm)(r,{title:"确认删除？","ok-text":"确认","cancel-text":"取消",onConfirm:e=>l.deleteIconClick(e,i)},{default:(0,o.w5)((()=>[I])),_:2},1032,["onConfirm"]),(0,o.wy)((0,o._)("input",{type:"file",class:"imageFileInput","data-image-id":i,onChange:e=>l.onFileChange(e,i)},null,40,b),[[a.F8,!1]])]),(0,o._)("div",S,[(0,o._)("div",v,[(0,o._)("div",k,[(0,o.wy)((0,o._)("img",{importance:"auto",onLoad:t[1]||(t[1]=(...e)=>l.imageLoad&&l.imageLoad(...e)),onClick:e=>l.imageClick(i)},null,40,_),[[h,e.thumbnail]]),(0,o.wy)((0,o._)("input",{type:"file",class:"thumbFileInput","data-thumb-id":i,onChange:e=>l.onFileChange(e,i)},null,40,N),[[a.F8,!1]])])]),(0,o.Wm)(d,{getPopupContainer:e=>e.parentNode},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.iD)("div",{class:"title",key:e.name,onClick:e=>l.imageClick(i)},(0,g.zw)(e.name),9,$))])),_:2},1032,["getPopupContainer"])])])),_:2},1024)))),128))])}var O=i(19755),T=i.n(O);const F={class:"contentListItem"};function x(e,t,i,a,s,n){return(0,o.wg)(),(0,o.iD)("div",F,[(0,o.WI)(e.$slots,"default",{},void 0,!0)])}var E={name:"e-ContentListItem"},L=i(83744);const A=(0,L.Z)(E,[["render",x],["__scopeId","data-v-6999a248"]]);var J=A,P=i(5050),U={name:"e-ContentList",data(){return{isShowBigImageEditButton:!1}},props:{list:{type:Array,default(){return[]}}},methods:{VMUrlDecode(e){return(0,P.EO)(e)},imageLoad(){this.$bus.$emit("itemImageLoad")},deleteIconClick(e,t){this.$emit("deleteCategoryClick",t)},imageClick(e){this.$emit("editDialogshow",e)},thumbClick(e){const t=`'${e.toString()}'`,i=document.querySelector(`input[data-thumb-id=${t}]`);i.click()},async onFileChange(e,t){let i=e.target.files||e.dataTransfer.files;if(!i.length)return;const o=await this.$print.getPrintedFile(i[0]);if(i=[o],!/image\/\w+/.test(i[0].type)){this.$toast.error("文件必须为图片！",240);const e=document.getElementById(inputId);return void(e.value="")}const a=e.target.getAttribute("class"),s=new FormData;s.append("image",i[0]);const n={className:a,index:t,formData:s};this.$emit("newImageUpload",n)},onClickTitle(e,t){const i=this,o=T()(e.target),a=o.text(),s=1*o.width(),n=.9*o.height(),l=T()("<input type='text' style='width:"+s+"px;height:"+n+"px;background-color:var(--color-background-grey);border:1px solid var(--color-background-light-green);border-radius:30px;outline:none;'/>");o.html(l),l.trigger("focus"),l.val(a),l.blur((function(){const e=T()(this).val();if(""===e)o.html(a),i.$emit("emptyNewTitle");else if(e===a)o.html(a),i.$emit("titleNoChange");else{const s=i.list.find((t=>t.name===e));if(s)return i.$emit("findSameTitle"),void o.html(a);o.html(e);const n={index:t,newText:e};i.$emit("updateTitle",n)}})),l.keydown((e=>{13===e.keyCode&&l.blur()}))}},components:{ContentListItem:J}};const R=(0,L.Z)(U,[["render",D],["__scopeId","data-v-1afc4d39"]]);var W=R,q=i(18470);const B=e=>((0,o.dD)("data-v-3fb27e09"),e=e(),(0,o.Cn)(),e),Z={id:"addOneWrapper"},V={id:"addOne"},j={class:"flexLayout"},z=B((()=>(0,o._)("p",{class:"label"},[(0,o._)("label",{for:"categoryName"},"类别名称：")],-1))),H={class:"flexLayout",style:{"margin-top":"30px"}},M={class:"label"},Q=(0,o.Uk)("上传类别大图："),Y=B((()=>(0,o._)("img",{src:q,alt:"",id:"bigImage"},null,-1))),K=[Y],G={class:"flexLayout",style:{"margin-top":"30px"}},X={class:"label"},ee=(0,o.Uk)("上传类别小图："),te=B((()=>(0,o._)("img",{src:q,alt:"",id:"thumb"},null,-1))),ie=[te],oe={class:"buttonZone"};function ae(e,t,i,s,n,l){return(0,o.wg)(),(0,o.iD)("div",Z,[(0,o._)("div",V,[(0,o._)("p",{class:"cancel",onClick:t[0]||(t[0]=(...e)=>l.cancelClick&&l.cancelClick(...e))}),(0,o._)("div",j,[z,(0,o._)("p",null,[(0,o.wy)((0,o._)("input",{type:"text",id:"categoryName","onUpdate:modelValue":t[1]||(t[1]=e=>n.categoryName=e),ref:"autoFocusInput"},null,512),[[a.nr,n.categoryName]])])]),(0,o._)("div",H,[(0,o._)("p",M,[(0,o._)("label",null,[Q,(0,o._)("input",{type:"file",id:"bigImageFileInput",onChange:t[2]||(t[2]=(...e)=>l.onFileChange&&l.onFileChange(...e))},null,32)])]),(0,o._)("div",{class:"imageP",onClick:t[3]||(t[3]=(...e)=>l.bigImageClick&&l.bigImageClick(...e))},K)]),(0,o._)("div",G,[(0,o._)("p",X,[(0,o._)("label",null,[ee,(0,o._)("input",{type:"file",id:"thumbFileInput",onChange:t[4]||(t[4]=(...e)=>l.onFileChange&&l.onFileChange(...e))},null,32)])]),(0,o._)("div",{class:"thumbP",onClick:t[5]||(t[5]=(...e)=>l.thumbClick&&l.thumbClick(...e))},ie)]),(0,o._)("p",oe,[(0,o._)("button",{class:"cancel other-button",onClick:t[6]||(t[6]=(...e)=>l.cancelClick&&l.cancelClick(...e))},"取消"),(0,o._)("button",{class:"ensure other-button",onClick:t[7]||(t[7]=(...e)=>l.ensureClick&&l.ensureClick(...e))},"确认")])])])}var se=i(75813),ne={name:"e-AddOne",props:{list:{type:Array,default(){return[]}}},data(){return{categoryName:"",bigImageImage:null,thumbImage:null,tempBigImageValue:null,tempThumbValue:null}},mounted(){this.$nextTick((()=>{this.$refs.autoFocusInput.focus()}))},methods:{cancelClick(){this.$emit("cancelClick")},ensureClick(){if(!this.categoryName||!this.bigImageImage||!this.thumbImage)return void alert("请完善信息");const e={id:+new Date,name:this.categoryName,date_created:new Date,image:this.bigImageImage,thumbnail:this.thumbImage};this.$emit("ensureClick",e)},bigImageClick(){if(""===this.categoryName)return void this.$emit("emptyCategoryName");const e=this.list.find((e=>e.name===this.categoryName));if(e)return void this.$emit("hadSameTitleFromList");const t=document.querySelector("#bigImageFileInput");t.click()},thumbClick(){if(""===this.categoryName)return void this.$emit("emptyCategoryName");const e=this.list.find((e=>e.name===this.categoryName));if(e)return void this.$emit("hadSameTitleFromList");const t=document.querySelector("#thumbFileInput");t.click()},async onFileChange(e){if(""===this.categoryName)return void this.$emit("emptyCategoryName");let t=e.target.files||e.dataTransfer.files;const i=e.target.getAttribute("id");if(!t.length)return;const o=await this.$print.getPrintedFile(t[0]);if(t=[o],!/image\/\w+/.test(t[0].type)){this.$toast.error("文件必须为图片！",240);const e=document.getElementById(i);return void(e.value="")}const a=new FormData;a.append("image",t[0]);const s=await(0,se.C)(a),{details:n}=s,{image_url:l}=n;if(l){if("bigImageFileInput"===i){this.bigImageImage=l;const e=document.querySelector("#bigImage");e.setAttribute("src",""),e.style.width="144px",e.style.height="144px",e.setAttribute("src",l)}if("thumbFileInput"===i){this.thumbImage=l;const e=document.querySelector("#thumb");e.setAttribute("src",""),e.style.width="70px",e.style.height="70px",e.setAttribute("src",l)}this.$emit("imageUploadSuccess")}else alert("图片上传失败")}}};const le=(0,L.Z)(ne,[["render",ae],["__scopeId","data-v-3fb27e09"]]);var re=le;const de=e=>((0,o.dD)("data-v-55e462ca"),e=e(),(0,o.Cn)(),e),ce={id:"editOneWrapper"},he={id:"editOne"},me={class:"flexLayout"},ge=de((()=>(0,o._)("p",{class:"label"},[(0,o._)("label",{for:"categoryName"},"类别名称：")],-1))),ue={class:"flexLayout",style:{"margin-top":"30px"}},we={class:"label"},pe=(0,o.Uk)("上传类别大图："),fe={alt:"big image of category",title:"单击修改大图",id:"bigImage"},ye={class:"flexLayout",style:{"margin-top":"30px"}},Ce={class:"label"},Ie=(0,o.Uk)("上传类别小图："),be={alt:"thumb image of category",title:"单击修改小图",id:"thumb"},Se={class:"buttonZone"};function ve(e,t,i,s,n,l){const r=(0,o.Q2)("lazy");return(0,o.wg)(),(0,o.iD)("div",ce,[(0,o._)("div",he,[(0,o._)("p",{class:"cancel",onClick:t[0]||(t[0]=(...e)=>l.cancelClick&&l.cancelClick(...e))}),(0,o._)("div",me,[ge,(0,o._)("p",null,[(0,o.wy)((0,o._)("input",{type:"text",id:"categoryName","onUpdate:modelValue":t[1]||(t[1]=e=>n.categoryName=e),ref:"autoFocusInput"},null,512),[[a.nr,n.categoryName]])])]),(0,o._)("div",ue,[(0,o._)("p",we,[(0,o._)("label",null,[pe,(0,o._)("input",{type:"file",id:"bigImageFileInput",onChange:t[2]||(t[2]=(...e)=>l.onFileChange&&l.onFileChange(...e))},null,32)])]),(0,o._)("div",{class:"imageP",onClick:t[3]||(t[3]=(...e)=>l.bigImageClick&&l.bigImageClick(...e))},[(0,o.wy)((0,o._)("img",fe,null,512),[[r,i.editIndex.image]])])]),(0,o._)("div",ye,[(0,o._)("p",Ce,[(0,o._)("label",null,[Ie,(0,o._)("input",{type:"file",id:"thumbFileInput",onChange:t[4]||(t[4]=(...e)=>l.onFileChange&&l.onFileChange(...e))},null,32)])]),(0,o._)("div",{class:"thumbP",onClick:t[5]||(t[5]=(...e)=>l.thumbClick&&l.thumbClick(...e))},[(0,o.wy)((0,o._)("img",be,null,512),[[r,i.editIndex.thumbnail]])])]),(0,o._)("p",Se,[(0,o._)("button",{class:"cancel other-button",onClick:t[6]||(t[6]=(...e)=>l.cancelClick&&l.cancelClick(...e))},"取消"),(0,o._)("button",{class:"ensure other-button",onClick:t[7]||(t[7]=(...e)=>l.ensureClick&&l.ensureClick(...e))},"确认")])])])}var ke={name:"e-editOne",data(){return{categoryName:this.editIndex.name,bigImageImage:this.editIndex.image,thumbImage:this.editIndex.thumbnail,tempBigImageValue:null,tempThumbValue:null}},mounted(){this.$nextTick((()=>{this.$refs.autoFocusInput.focus()}))},props:{editNum:{type:Number,default(){return 0}},editIndex:{type:Array,default(){return[]}},list:{type:Array,default(){return[]}}},activated(){console.log(this.editIndex)},methods:{VMUrlDecode(e){return(0,P.EO)(e)},cancelClick(){this.$emit("cancelClick")},async onFileChange(e){if(""===this.categoryName)return void this.$emit("emptyCategoryName");let t=e.target.files||e.dataTransfer.files;const i=e.target.getAttribute("id");if(!t.length)return;const o=await this.$print.getPrintedFile(t[0]);if(t=[o],!/image\/\w+/.test(t[0].type)){this.$toast.error("文件必须为图片！",240);const e=document.getElementById(i);return void(e.value="")}const a=new FormData;a.append("image",t[0]);const s=await(0,se.C)(a),{details:n}=s,{image_url:l}=n;if(l){if("bigImageFileInput"===i){this.bigImageImage=l;const e=document.querySelector("#bigImage");e.setAttribute("src",""),e.style.width="144px",e.style.height="144px",e.setAttribute("src",l)}if("thumbFileInput"===i){this.thumbImage=l;const e=document.querySelector("#thumb");e.setAttribute("src",""),e.style.width="70px",e.style.height="70px",e.setAttribute("src",l)}this.$emit("imageUploadSuccess")}else alert("图片上传失败")},bigImageClick(){if(""===this.categoryName)return void this.$emit("emptyCategoryName");const e=document.querySelector("#bigImageFileInput");e.click()},thumbClick(){if(""===this.categoryName)return void this.$emit("emptyCategoryName");const e=document.querySelector("#thumbFileInput");e.click()},ensureClick(){if(!this.categoryName||!this.bigImageImage||!this.thumbImage)return void alert("请完善信息");const e={id:this.editIndex.id,name:this.categoryName,date_created:new Date,image:this.bigImageImage,thumbnail:this.thumbImage};console.log(e),this.$emit("ensureClick",e)}}};const _e=(0,L.Z)(ke,[["render",ve],["__scopeId","data-v-55e462ca"]]);var Ne=_e,$e=i(85534),De=i(6819),Oe=i(2886),Te=i(92058),Fe={name:"e-Category",beforeRouteEnter(e,t,i){"true"===window.localStorage.getItem("isStaff")?(window.localStorage.setItem("currentIndex010001",0),i()):(i({path:"/tools/login"}),window.localStorage.removeItem("list"),window.localStorage.removeItem("order"),window.localStorage.removeItem("currentIndex010001"),window.localStorage.removeItem("userID"),window.localStorage.removeItem("username"),window.localStorage.removeItem("authToken"),window.localStorage.removeItem("isStaff"),window.localStorage.removeItem("isSuperUser"),window.localStorage.removeItem("isProvider"))},async beforeRouteLeave(e,t,i){if(window.stop(),0===this.order.add.length&&0===this.order.update.length&&0===this.order.delete.length)i();else if(confirm("您有修改未提交，确认离开？")){this.order={add:[],update:[],delete:[]},window.localStorage.setItem("order",window.JSON.stringify(this.order));const e=window.JSON.parse(window.JSON.stringify(this.originList));this.list=e,window.localStorage.setItem("list",window.JSON.stringify(this.list)),i()}else window.localStorage.setItem("currentIndex010001",0),this.$bus.$emit("setCurrentIndex010001To0"),i(!1)},async mounted(){console.log("activitated",this),this.$refs.scroll&&this.$refs.scroll.refresh();const e=await(0,$e._)();console.log("categories",e);const{details:t}=e,i=Object.values(t);i.forEach((e=>{this.list.push(window.JSON.parse(window.JSON.stringify(e))),this.originList.push(window.JSON.parse(window.JSON.stringify(e)))})),window.localStorage.setItem("list",window.JSON.stringify(this.list)),window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.$refs.scroll&&(this.debounceRefresh=(0,P.Ds)(this.$refs.scroll.refresh,500)),this.$bus.$on("itemImageLoad",(()=>{}))},activated(){this.showimg=!1;let e=this;setTimeout((function(){e.showimg=!0}),100),console.log(233)},deactivated(){this.$bus.$off("itemImageLoad")},data(){return{showimg:!0,isLoading:!1,debounceRefresh:null,isShowAddOneDialog:!1,isShowEditOneDialog:!1,list:[],order:{add:[],update:[],delete:[]},isShowCoverPage:!1,activeEditID:-1,isShowEditReasonDialog:!1,ifShowBackTop:!1,originList:[],editNum:0,editIndex:[]}},methods:{deleteCategoryItem(e){const t=window.JSON.parse(window.JSON.stringify(this.list[e]));window.localStorage.setItem("list",window.JSON.stringify(this.list));const i=this.originList.find((e=>e.id===t.id));this.order.delete.push(i),console.log(i),window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.isShowEditReasonDialog=!0,this.isShowCoverPage=!0},showAddOneDialog(){this.isShowCoverPage=!0,this.isShowAddOneDialog=!0},addOne(e){this.isShowAddOneDialog=!1,this.isShowCoverPage=!1;const{name:t}=e,i=this.list.find((e=>e.name===t));i?this.$toast.warn("该类别已存在",240):(window.localStorage.setItem("list",window.JSON.stringify(this.list)),this.$refs.scroll.refresh(),setTimeout((()=>{this.$refs.scroll.scrollTo(0,this.$refs.scroll.scroll.maxScrollY,500)}),1e3),this.order.add.push(e),window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.isShowEditReasonDialog=!0,this.isShowCoverPage=!0)},cancelClickOfAddOne(){this.isShowAddOneDialog=!1,this.isShowCoverPage=!1},emptyCategoryNameToast(){this.$toast.error("请先填写类别名",240)},hadSameTitleFromListToast(){this.$toast.error("该类别名已存在",240)},imageUploadSuccessToast(){this.$toast.success("上传成功",240)},async newImageUpload(e){const{className:t,index:i,formData:o}=e;try{const e=await(0,se.C)(o);if(200===e.Code&&"success"===e.msg){this.$toast.success("上传成功",240);const{details:o}=e,{image_url:a}=o;"imageFileInput"===t&&this.$set(this.list[i],"image",a),"thumbFileInput"===t&&this.$set(this.list[i],"thumbnail",a),window.localStorage.setItem("list",window.JSON.stringify(this.list)),this.activeEditID=this.list[i].id;const s=this.order.add.find((e=>e.id===this.activeEditID));if(s)"imageFileInput"===t&&(s.image=a),"thumbFileInput"===t&&(s.thumbnail=a);else{const e=this.order.update.find((e=>e.id===this.activeEditID));if(e)"imageFileInput"===t&&(e.image=a),"thumbFileInput"===t&&(e.thumbnail=a);else{if("imageFileInput"===t){const e={id:this.activeEditID,image:a};this.order.update.push(e)}if("thumbFileInput"===t){const e={id:this.activeEditID,thumbnail:a};this.order.update.push(e)}}}window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.activeEditID=-1}else this.$toast.error("上传失败",240)}catch(a){this.$toast.error("上传失败",240)}},emptyNewTitleToast(){this.$toast.warn("类别名不能为空",240)},findSameTitleToast(){this.$toast.warn("该类别名已存在",240)},updateTitle(e){const{index:t,newText:i}=e;this.activeEditID=this.list[t].id,this.$set(this.list[t],"name",i),window.localStorage.setItem("list",window.JSON.stringify(this.list));const o=this.order.add.find((e=>e.id===this.activeEditID));if(o)this.$toast.success("修改成功",240),o.name=i;else{const e=this.order.update.find((e=>e.id===this.activeEditID));if(e)if(e.name){const t=this.originList.find((e=>e.id===this.activeEditID));if(t.name===i)if(this.$toast.warn("本次修改后与原类别名称一致",240,230),2===Object.keys(e).length){const t=this.order.update.indexOf(e);this.order.update.splice(t,1)}else delete e.name;else this.$toast.success("修改成功",240),e.name=i}else this.$toast.success("修改成功",240),e.name=i;else{this.$toast.success("修改成功",240);const e={id:this.activeEditID,name:i};this.order.update.push(e)}}window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.activeEditID=-1},titleNoChange(){this.$toast.warn("未检查到更改",240)},showEditReasonDialog(){this.isShowEditReasonDialog=!0,this.isShowCoverPage=!0},async deployOrder(){console.log(this.order.add);const{message:e}=this.$refs.editReasonDialog;if(!e)return void this.$toast.warn("请填写编辑理由",240);if(0===this.order.add.length&&0===this.order.update.length&&0===this.order.delete.length)return void this.$toast.warn("未有有效编辑",240);if(0!=this.order.add.length)var t={user:{id:Number(window.localStorage.getItem("userID"))},version:"1.0.0",create_reason:e,work_line_id:1200,work_operation:4200,content:{name:this.order.add[0].name,image:this.order.add[0].image,thumbnail:this.order.add[0].thumbnail}};if(0!=this.order.update.length)t={user:{id:Number(window.localStorage.getItem("userID"))},version:"1.0.0",create_reason:e,work_line_id:1200,work_operation:4300,content:{id:this.order.update[0].id,name:this.order.update[0].name,image:this.order.update[0].image,thumbnail:this.order.update[0].thumbnail}};if(0!=this.order.delete.length)t={user:{id:Number(window.localStorage.getItem("userID"))},version:"1.0.0",create_reason:e,work_line_id:1200,work_operation:4900,content:{id:this.order.delete[0].id}};const i=await(0,$e.U)(t);if(this.isShowEditReasonDialog=!1,i){const{Code:e,msg:t}=i;200===e&&"success"===t?(this.$toast.success("提交成功，请等待审核",240,200,1e3),this.isShowCoverPage=!1,this.order={add:[],update:[],delete:[]},window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.$refs.scroll.scrollTo(0,0,300)):this.$toast.error("提交出错，请稍后再试",240)}else alert("提交失败")},cancelClickOfEditReasonDialog(){this.isShowEditReasonDialog=!1,this.isShowCoverPage=!1},resetListAndOrder(){if(0===this.order.add.length&&0===this.order.update.length&&0===this.order.delete.length)return void this.$toast.warn("当前没有修改",240);this.order.add.splice(0,this.order.add.length),this.order.update.splice(0,this.order.update.length),this.order.delete.splice(0,this.order.delete.length),window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.list.splice(0,this.list.length);const e=window.JSON.parse(window.JSON.stringify(this.originList));this.list.push(...e),window.localStorage.setItem("list",window.JSON.stringify(this.list)),setTimeout((()=>{this.$toast.success("页面回退到修改前",240)}),100)},scrollToTop(){this.$refs.scroll.scrollTo(0,0,500)},printPosition(e){this.ifShowBackTop=-e.y>400},editDialogshow(e){this.editNum=e,this.editIndex=this.list[e],console.log(this.list[e]),this.isShowEditOneDialog=!0,this.isShowCoverPage=!0},cancelClickOfEditOne(){this.isShowEditOneDialog=!1,this.isShowCoverPage=!1},editOne(e){console.log(e,"afteredit"),this.isShowEditOneDialog=!1,this.isShowCoverPage=!1,this.order.update.push(e),window.localStorage.setItem("order",window.JSON.stringify(this.order)),this.isShowEditReasonDialog=!0,this.isShowCoverPage=!0}},computed:{getAccount(){return window.localStorage.getItem("name")}},watch:{},components:{Scroll:m.Z,ContentList:W,AddOne:re,EditOne:Ne,EditReasonDialog:De.Z,BackTop:Oe.Z,Loading:Te.Z}};const xe=(0,L.Z)(Fe,[["render",h],["__scopeId","data-v-b168a6e8"]]);var Ee=xe}}]);
//# sourceMappingURL=7193.7eec3b96.js.map